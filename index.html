<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Ejemplos de descarga</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 2rem; line-height: 1.5; }
    h1 { margin-bottom: .25rem; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 1rem 1.25rem; margin: 1rem 0; }
    a.button, button { display: inline-block; padding: .6rem 1rem; border-radius: 10px; border: 1px solid #ccc; cursor: pointer; text-decoration: none; }
    a.button:hover, button:hover { background: #f4f4f4; }
    code { background: #f6f8fa; padding: .15rem .35rem; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>Descargar archivos</h1>
  <p>Ejemplos pr치cticos para ofrecer descargas desde una p치gina web.</p>

  <!-- 1) Enlace directo con atributo "download" -->
  <section class="card">
    <h2>1) Enlace directo (mismo dominio)</h2>
    <p>
      Pon칠 el archivo (ej. <code>archivo.pdf</code>) en la misma carpeta que este HTML.<br>
      El atributo <code>download</code> sugiere guardar el archivo con un nombre.
    </p>
    <p>
      <a class="button" href="archivo.pdf" download="MiArchivo.pdf">Descargar PDF</a>
    </p>
    <small>Nota: navegadores pueden ignorar <code>download</code> en enlaces a otros dominios.</small>
  </section>

  <!-- 2) Generar y descargar un archivo en el momento (Blob) -->
  <section class="card">
    <h2>2) Generar un archivo con JavaScript (Blob)</h2>
    <p>Esto crea un archivo de texto en memoria y lo descarga.</p>
    <p>
      <button id="btn-blob">Descargar TXT generado</button>
    </p>
  </section>

  <!-- 3) Descargar un archivo remoto y forzar nombre local -->
  <section class="card">
    <h2>3) Descargar remoto con fetch y Blob</h2>
    <p>
      Descarga un archivo desde una URL (mismo origen o CORS permitido) y lo guarda con el nombre que elijas.
    </p>
    <div style="display:flex; gap:.5rem; flex-wrap:wrap;">
      <input id="url-remota" type="url" placeholder="https://ejemplo.com/archivo.pdf" style="flex:1; min-width:260px; padding:.55rem; border-radius:10px; border:1px solid #ccc;" />
      <input id="nombre-salida" type="text" placeholder="DescargaRemota.pdf" style="width:220px; padding:.55rem; border-radius:10px; border:1px solid #ccc;" />
      <button id="btn-fetch">Descargar</button>
    </div>
    <small>Necesita que el servidor remoto permita CORS para que <code>fetch</code> funcione desde el navegador.</small>
  </section>

  <script>
    // (2) Generar archivo en el momento
    document.getElementById('btn-blob').addEventListener('click', () => {
      const contenido = [
        'Hola 游녦',
        'Este archivo fue generado con JavaScript (Blob).',
        'Fecha: ' + new Date().toLocaleString()
      ].join('\n');

      const blob = new Blob([contenido], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);

      const a = document.createElement('a');
      a.href = url;
      a.download = 'Generado.txt';
      document.body.appendChild(a);
      a.click();

      URL.revokeObjectURL(url);
      a.remove();
    });

    // (3) Descargar remoto con fetch y forzar nombre
    document.getElementById('btn-fetch').addEventListener('click', async () => {
      const url = document.getElementById('url-remota').value.trim();
      const nombre = document.getElementById('nombre-salida').value.trim() || 'descarga';

      if (!url) {
        alert('Ingres치 una URL v치lida.');
        return;
      }
      try {
        const resp = await fetch(url, { mode: 'cors' });
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        const blob = await resp.blob();

        const dlUrl = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = dlUrl;
        a.download = nombre;
        document.body.appendChild(a);
        a.click();
        URL.revokeObjectURL(dlUrl);
        a.remove();
      } catch (e) {
        console.error(e);
        alert('No se pudo descargar. Verific치 la URL y CORS del servidor.');
      }
    });
  </script>

  <hr>
  <p><strong>Sugerencia del lado del servidor:</strong> para que navegadores siempre traten el recurso como descarga,
    configur치 la cabecera HTTP <code>Content-Disposition: attachment; filename="MiArchivo.ext"</code>.</p>
</body>
</html>

