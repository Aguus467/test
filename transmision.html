<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>TransmisiÃ³n en Vivo - AngulismoTV</title>
<link rel="shortcut icon" href="assets/logo.png" type="image/x-icon">
<meta name="description" content="Disfruta de transmisiones en vivo de tus canales favoritos con experiencia personalizable">

<!-- Meta tags optimizados -->
<meta name="theme-color" content="#0b0d1b">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Resource Hints para mejor performance -->
<!-- DNS Prefetch -->
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">

<!-- Preconnect para conexiones crÃ­ticas -->
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Preload de recursos crÃ­ticos -->
<link rel="preload" href="assets/logo2.png" as="image" type="image/png">
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style">

<!-- Prefetch de pÃ¡ginas probables -->
<link rel="prefetch" href="index.html">
<link rel="prefetch" href="multicam.html">
<link rel="prefetch" href="foro.html">

<link rel="icon" href="assets/logo2.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<!-- CRÃTICO: Cargar con alta prioridad -->
<link rel="stylesheet" href="css/espacial-base.css">
<link rel="stylesheet" href="css/transmision.css">

<!-- NO CRÃTICO: Cargar con baja prioridad (despuÃ©s de renderizado inicial) -->
<link rel="stylesheet" href="css/header-unificado.css" media="print" onload="this.media='all'">
<link rel="stylesheet" href="css/reproductor-musica.css" media="print" onload="this.media='all'">

<!-- Fallback para navegadores sin JS -->
<noscript>
  <link rel="stylesheet" href="css/header-unificado.css">
  <link rel="stylesheet" href="css/reproductor-musica.css">
</noscript>


<!-- Google Analytics -->
<script>
  // Cargar Google Analytics de forma no bloqueante
  window.addEventListener('load', function() {
    setTimeout(function() {
      var gaScript = document.createElement('script');
      gaScript.async = true;
      gaScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-P2V7GWXLHJ';
      document.head.appendChild(gaScript);
      
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-P2V7GWXLHJ');
    }, 1500);
  });
</script>
</head>
<body>

<!-- Starfield Background -->
<div id="starfield">
  <div class="spiral-galaxy"></div>
  <div class="aurora aurora-1"></div>
  <div class="aurora aurora-2"></div>
</div>


<header class="site-header">
  <div class="header-container">
    <div class="logo-container">
      <a href="index.html" aria-label="AngulismoTV - Inicio">
        <img src="assets/logo2.png" alt="AngulismoTV" class="logo">
      </a>
    </div>
    
    <!-- Agrega el botÃ³n hamburguesa -->
    <button class="menu-toggle" aria-label="Abrir menÃº de navegaciÃ³n">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>

    <!-- Tu navegaciÃ³n actual (se mantiene igual) -->
    <nav role="navigation" aria-label="NavegaciÃ³n principal">
      <a href="index.html#channelsSection">Canales</a>
      <a href="index.html">Agenda</a>
      <a href="multicam.html">Pantalla Dividida</a>
      <a href="https://nowevents.xyz">Entretenimiento</a>
      <a href="https://nowstats.netlify.app">EstadÃ­sticas</a>
      <a href="foro.html">Foro</a>
    </nav>

  </div>
</header>

<!-- Options Bar -->
<section class="options-bar">

    <div class="card-header">
      <div class="channel-head" id="channel-info">
        <img id="channel-logo" src="assets/logo.png" alt="Logo del canal">
        <div class="channel-info">
          <span class="name" id="channel-name">Canal</span>
        </div>
      </div>
    </div>

    
    <select id="optionSelect" aria-label="Seleccionar transmisiÃ³n">
    <option value="">Cargando</option>
    </select>

    <button class="btn" id="reloadBtn" aria-label="Recargar transmisiÃ³n">
      Recargar
    <svg class="icon-reload" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
    </svg>
    </button>
<label> Alternar chat:</label>
    <div class="card-header">
      <button class="chat-toggle" id="chatToggle" aria-label="Minimizar chat">
               <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
            <path d="M8 11h8M8 15h6"/>
            <path d="M12 5v14"/>
          </svg>
      </button>
    </div>

    
 

  <div class="music-controls">
    <div class="music-info">Musica ambiental</div>
    <div class="volume-control" id="volumeControl">
        <div class="volume-slider" id="volumeSlider"></div>
        <div class="volume-handle" id="volumeHandle"></div>
    </div>
    <button class="music-toggle" id="musicToggle" aria-label="Reproducir/Pausar mÃºsica">
        <span id="musicIcon">â–¶</span>
    </button>
</div>
</section>

<!-- Main Content -->
<main class="container">
  <!-- Player Card -->
  <section class="card player-card">
<iframe 
  id="playerFrame"
  scrolling="no"
  allowfullscreen
  webkitallowfullscreen
  mozallowfullscreen
  msallowfullscreen
  referrerpolicy="no-referrer" 
  allow="autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope"
  title="Reproductor de transmisiÃ³n en vivo"
  loading="lazy"
  importance="high"
  width="100%"
  height="auto">
</iframe>
  </section>

  <!-- Chat Card -->
  <aside class="card chat-card">
<iframe 
  id="twitchChat" 
  src="" 
  title="Chat de Twitch" 
  referrerpolicy="no-referrer"
  loading="lazy"
  importance="low"
  width="100%"
  height="100%"
  sandbox="allow-same-origin allow-scripts allow-popups allow-forms">
</iframe>
  </aside>
</main>


<!-- Footer -->
<footer class="site-footer">
  <small>Â© 2025 AngulismoTV | <a href="dmca.html">DMCA</a></small>
  <small>
    <a href="https://x.com/AngulismoTV">Twitter</a> | 
    <a href="https://discord.gg/jEayDA7T">Discord</a>
  </small>
</footer>

<audio id="backgroundMusic" loop preload="none">
    <!-- Las fuentes se cargan bajo demanda cuando el usuario activa la mÃºsica -->
    <source src="music/background-music.mp3" type="audio/mpeg">
    <source src="music/background-music.ogg" type="audio/ogg">
    Tu navegador no soporta el elemento de audio.
</audio>



<!-- Scripts -->
<script src="scripts/header-mobile.js"></script>
<script defer src="scripts/transmision.js"></script>
<script defer src="scripts/transmision-ui.js"></script>
<script>
  window.addEventListener('load', function() {
    setTimeout(function() {
      var musicScript = document.createElement('script');
      musicScript.src = 'scripts/musica-ambiental.js';
      musicScript.defer = true;
      document.body.appendChild(musicScript);
    }, 1000);
  });
</script>

<script>
(function() {
  'use strict';

  // ==================== ConfiguraciÃ³n adaptativa ====================
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  
  // Reducir elementos en pÃ¡gina de transmisiÃ³n (prioridad al video)
  const numStars = isMobile ? 20 : 40;
  const numShootingStars = isMobile ? 0 : 1;
  const numComets = 0; // Desactivado en transmisiÃ³n
  const numPlanets = isMobile ? 0 : 1;
  const numStardust = isMobile ? 8 : 15;
  
  const BATCH_SIZE = 8;
  const BATCH_DELAY = 40;

  // ==================== Funciones de creaciÃ³n ====================
  function createElement(className, styles = {}) {
    const el = document.createElement('div');
    el.className = className;
    Object.keys(styles).forEach(prop => {
      el.style[prop] = styles[prop];
    });
    return el;
  }

  const starfield = document.getElementById('starfield');
  if (!starfield) return;

  // ==================== Crear estrellas en lotes ====================
  function createStarsBatch(startIdx, endIdx) {
    const fragment = document.createDocumentFragment();
    
    for (let i = startIdx; i < Math.min(endIdx, numStars); i++) {
      const layer = Math.floor(Math.random() * 3) + 1;
      const size = Math.random() * 2 + 0.5;
      
      const star = createElement(`star layer-${layer}`, {
        width: size + 'px',
        height: size + 'px',
        top: Math.random() * 100 + '%',
        left: Math.random() * 100 + '%',
        animationDelay: Math.random() * 4 + 's',
        animationDuration: (Math.random() * 3 + 3) + 's'
      });
      
      star.setAttribute('data-speed', layer * 0.15);
      fragment.appendChild(star);
    }
    
    starfield.appendChild(fragment);
    
    if (endIdx < numStars) {
      setTimeout(() => {
        createStarsBatch(endIdx, endIdx + BATCH_SIZE);
      }, BATCH_DELAY);
    } else {
      createOtherElements();
    }
  }

  // ==================== Crear otros elementos ====================
  function createOtherElements() {
    const fragment = document.createDocumentFragment();
    
    // Shooting stars (solo PC, muy reducidos)
    if (!isMobile) {
      for (let i = 0; i < numShootingStars; i++) {
        const shootingStar = createElement('shooting-star', {
          top: Math.random() * 50 + '%',
          left: (Math.random() * 50 + 50) + '%',
          animationDelay: (Math.random() * 8 + 4) + 's',
          animationDuration: (Math.random() * 3 + 3) + 's',
          width: (Math.random() * 80 + 40) + 'px'
        });
        fragment.appendChild(shootingStar);
      }
    }

    // Planeta (solo en PC)
    if (!isMobile && numPlanets > 0) {
      const planet = createElement('planet planet-1');
      fragment.appendChild(planet);
    }

    // Polvo estelar (muy reducido)
    for (let i = 0; i < numStardust; i++) {
      const dust = createElement('stardust', {
        left: Math.random() * 100 + '%',
        bottom: '0',
        animationDelay: Math.random() * 25 + 's',
        animationDuration: (Math.random() * 12 + 18) + 's'
      });
      fragment.appendChild(dust);
    }

    starfield.appendChild(fragment);
    setTimeout(cacheStars, 200);
  }

  // ==================== Iniciar creaciÃ³n ====================
  // Delay inicial para priorizar carga del reproductor
  setTimeout(() => {
    createStarsBatch(0, BATCH_SIZE);
  }, 500);

  // ==================== Efecto Paralaje MINIMALISTA ====================
  let scrollY = 0;
  let ticking = false;
  let stars = [];

  function cacheStars() {
    stars = Array.from(document.querySelectorAll('.star[data-speed]'));
  }

  function updateParallax() {
    if (stars.length === 0) return;
    
    stars.forEach(star => {
      const speed = parseFloat(star.getAttribute('data-speed')) || 0;
      const yPos = scrollY * speed;
      star.style.transform = `translateY(${yPos}px)`;
    });
    ticking = false;
  }

  function handleScroll() {
    scrollY = window.pageYOffset;
    if (!ticking) {
      requestAnimationFrame(updateParallax);
      ticking = true;
    }
  }

  // Intersection Observer para activar paralaje solo cuando es visible
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        window.addEventListener('scroll', handleScroll, { passive: true });
      } else {
        window.removeEventListener('scroll', handleScroll);
      }
    });
  }, { rootMargin: '100px' });

  observer.observe(starfield);

  // ==================== Reducir animaciones si el usuario lo prefiere ====================
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    const animatedElements = document.querySelectorAll('.star, .shooting-star, .planet, .stardust, .aurora, .spiral-galaxy');
    animatedElements.forEach(el => {
      el.style.animation = 'none';
    });
  }

  // ==================== Cleanup ====================
  window.addEventListener('beforeunload', function() {
    window.removeEventListener('scroll', handleScroll);
    observer.disconnect();
  });

  console.log('AngulismoTV TransmisiÃ³n - Starfield minimalista optimizado ðŸŽ¬');

})();
</script>
</body>
</html>